Using cache found in /home/s1/eugenebaek/.cache/torch/hub/facebookresearch_dino_main
Using device: cuda:0
Editing from 4556!
Start iterations 0
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:08<08:47,  8.94s/it]  3%|▎         | 2/60 [00:09<04:01,  4.16s/it]  5%|▌         | 3/60 [00:10<02:30,  2.63s/it]  7%|▋         | 4/60 [00:11<01:47,  1.92s/it]  8%|▊         | 5/60 [00:12<01:23,  1.52s/it] 10%|█         | 6/60 [00:13<01:09,  1.28s/it] 12%|█▏        | 7/60 [00:13<00:59,  1.13s/it] 13%|█▎        | 8/60 [00:14<00:53,  1.03s/it] 15%|█▌        | 9/60 [00:15<00:49,  1.04it/s] 17%|█▋        | 10/60 [00:16<00:45,  1.10it/s] 18%|█▊        | 11/60 [00:17<00:42,  1.15it/s] 20%|██        | 12/60 [00:17<00:40,  1.19it/s] 22%|██▏       | 13/60 [00:18<00:38,  1.22it/s] 23%|██▎       | 14/60 [00:19<00:37,  1.24it/s] 25%|██▌       | 15/60 [00:20<00:35,  1.25it/s] 27%|██▋       | 16/60 [00:20<00:34,  1.26it/s] 28%|██▊       | 17/60 [00:21<00:33,  1.27it/s] 30%|███       | 18/60 [00:22<00:32,  1.27it/s] 32%|███▏      | 19/60 [00:23<00:32,  1.28it/s] 33%|███▎      | 20/60 [00:24<00:31,  1.28it/s] 35%|███▌      | 21/60 [00:24<00:30,  1.28it/s] 37%|███▋      | 22/60 [00:25<00:29,  1.28it/s] 38%|███▊      | 23/60 [00:26<00:28,  1.28it/s] 40%|████      | 24/60 [00:27<00:28,  1.28it/s] 42%|████▏     | 25/60 [00:27<00:27,  1.28it/s] 43%|████▎     | 26/60 [00:28<00:26,  1.28it/s] 45%|████▌     | 27/60 [00:29<00:25,  1.28it/s] 47%|████▋     | 28/60 [00:30<00:24,  1.28it/s] 48%|████▊     | 29/60 [00:31<00:24,  1.28it/s] 50%|█████     | 30/60 [00:31<00:23,  1.28it/s] 52%|█████▏    | 31/60 [00:32<00:22,  1.28it/s] 53%|█████▎    | 32/60 [00:33<00:21,  1.28it/s] 55%|█████▌    | 33/60 [00:34<00:21,  1.28it/s] 57%|█████▋    | 34/60 [00:34<00:20,  1.28it/s] 58%|█████▊    | 35/60 [00:35<00:19,  1.28it/s] 60%|██████    | 36/60 [00:36<00:18,  1.28it/s] 62%|██████▏   | 37/60 [00:37<00:17,  1.28it/s] 63%|██████▎   | 38/60 [00:38<00:17,  1.28it/s] 65%|██████▌   | 39/60 [00:38<00:16,  1.28it/s] 67%|██████▋   | 40/60 [00:39<00:15,  1.28it/s] 68%|██████▊   | 41/60 [00:40<00:14,  1.28it/s] 70%|███████   | 42/60 [00:41<00:14,  1.28it/s] 72%|███████▏  | 43/60 [00:41<00:13,  1.28it/s] 73%|███████▎  | 44/60 [00:42<00:12,  1.28it/s] 75%|███████▌  | 45/60 [00:43<00:11,  1.28it/s] 77%|███████▋  | 46/60 [00:44<00:10,  1.28it/s] 78%|███████▊  | 47/60 [00:45<00:10,  1.28it/s] 80%|████████  | 48/60 [00:45<00:09,  1.28it/s] 82%|████████▏ | 49/60 [00:46<00:08,  1.28it/s] 83%|████████▎ | 50/60 [00:47<00:07,  1.28it/s] 85%|████████▌ | 51/60 [00:48<00:07,  1.28it/s] 87%|████████▋ | 52/60 [00:48<00:06,  1.28it/s] 88%|████████▊ | 53/60 [00:49<00:05,  1.28it/s] 90%|█████████ | 54/60 [00:50<00:04,  1.28it/s] 92%|█████████▏| 55/60 [00:51<00:03,  1.28it/s] 93%|█████████▎| 56/60 [00:52<00:03,  1.28it/s] 95%|█████████▌| 57/60 [00:52<00:02,  1.28it/s] 97%|█████████▋| 58/60 [00:53<00:01,  1.28it/s] 98%|█████████▊| 59/60 [00:54<00:00,  1.28it/s]100%|██████████| 60/60 [00:55<00:00,  1.28it/s]100%|██████████| 60/60 [00:55<00:00,  1.09it/s]
Traceback (most recent call last):
  File "/home/s1/eugenebaek/EditBench_eugene/DiffuseIT/main.py", line 35, in <module>
    image_editor.edit_image_by_prompt(init_image_pil, original_caption, target_caption, task_idx)
  File "/home/s1/eugenebaek/EditBench_eugene/DiffuseIT/optimization/image_editor.py", line 176, in edit_image_by_prompt
    self.E_S, self.E_T = E_S, E_T =  self.clip_net.encode_text([txt1, txt2])
  File "/home/s1/eugenebaek/EditBench_eugene/DiffuseIT/src/vqc_core.py", line 117, in encode_text
    return TensorDict({name:model.encode_text(x) for name, model in self.networks.items()})
  File "/home/s1/eugenebaek/EditBench_eugene/DiffuseIT/src/vqc_core.py", line 117, in <dictcomp>
    return TensorDict({name:model.encode_text(x) for name, model in self.networks.items()})
  File "/home/s1/eugenebaek/EditBench_eugene/DiffuseIT/src/vqc_core.py", line 96, in encode_text
    tokens = clip.tokenize(text_template).to(self.device)
  File "/home/s1/eugenebaek/anaconda3/envs/DiffuseIT/lib/python3.9/site-packages/clip/clip.py", line 242, in tokenize
    raise RuntimeError(f"Input {texts[i]} is too long for context length {context_length}")
RuntimeError: Input a bad photo of a A small, white boat with a dark blue stripe and a white cabin, powered by a propeller, moves slowly through the calm waters of the bay, with a group of people on board, including a man and a woman, both wearing sunglasses and casual clothing, and a few fishing rods and nets visible on the boat, as they pass by the nearby zoo.. is too long for context length 77
